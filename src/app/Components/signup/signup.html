<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card shadow-lg">
        <div class="card-header bg-primary text-white text-center">
          <h3>ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
        </div>
        <div class="card-body">
          
          <!-- Error Message -->
          @if(errorMessage) {
            <div class="alert alert-danger" role="alert">
              {{ errorMessage }}
            </div>
          }

          <!-- Template Driven Form -->
          <form #signupForm="ngForm" (ngSubmit)="onSubmit(signupForm)">
            
            <!-- Name Field -->
            <div class="mb-3">
              <label for="name" class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
              <input
                type="text"
                class="form-control"
                id="name"
                name="name"
                [(ngModel)]="user.name"
                #name="ngModel"
                required
                minlength="5"
                [class.is-valid]="name.valid && (name.dirty || name.touched || submitted)"
                [class.is-invalid]="name.invalid && (name.dirty || name.touched || submitted)"
                placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„"
              />
              
              @if(name.valid && (name.dirty || name.touched || submitted)) {
                <div class="valid-feedback">
                  âœ“ ØªÙ…Ø§Ù…! Ø§Ù„Ø§Ø³Ù… ØµØ­ÙŠØ­
                </div>
              }

              @if(name.errors?.['required'] && (name.dirty || name.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-danger mt-2 py-1 mb-0">
                    âš ï¸ Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨!
                  </div>
                </div>
              }

              @if(name.errors?.['minlength'] && (name.dirty || name.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-warning mt-2 py-1 mb-0">
                    âš ï¸ Ø§Ù„Ø§Ø³Ù… Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† 5 Ø­Ø±ÙˆÙ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„!
                  </div>
                </div>
              }
            </div>

            <!-- Email Field -->
            <div class="mb-3">
              <label for="email" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
              <input
                type="email"
                class="form-control"
                id="email"
                name="email"
                [(ngModel)]="user.email"
                #email="ngModel"
                required
                email
                [class.is-valid]="email.valid && (email.dirty || email.touched || submitted)"
                [class.is-invalid]="email.invalid && (email.dirty || email.touched || submitted)"
                placeholder="example@email.com"
              />
              
              @if(email.valid && (email.dirty || email.touched || submitted)) {
                <div class="valid-feedback">
                  âœ“ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ØµØ­ÙŠØ­!
                </div>
              }

              @if(email.errors?.['required'] && (email.dirty || email.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-danger mt-2 py-1 mb-0">
                    âš ï¸ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø·Ù„ÙˆØ¨!
                  </div>
                </div>
              }

              @if(email.errors?.['email'] && (email.dirty || email.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-warning mt-2 py-1 mb-0">
                    âš ï¸ ØµÙŠØºØ© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­Ø©!
                  </div>
                </div>
              }
            </div>

            <!-- Password Field -->
            <div class="mb-3">
              <label for="password" class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
              <input
                type="password"
                class="form-control"
                id="password"
                name="password"
                [(ngModel)]="user.password"
                #password="ngModel"
                required
                minlength="6"
                [class.is-valid]="password.valid && (password.dirty || password.touched || submitted)"
                [class.is-invalid]="password.invalid && (password.dirty || password.touched || submitted)"
                placeholder="Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
              />
              
              @if(password.valid && (password.dirty || password.touched || submitted)) {
                <div class="valid-feedback">
                  âœ“ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©!
                </div>
              }

              @if(password.errors?.['required'] && (password.dirty || password.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-danger mt-2 py-1 mb-0">
                    âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø©!
                  </div>
                </div>
              }

              @if(password.errors?.['minlength'] && (password.dirty || password.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-warning mt-2 py-1 mb-0">
                    âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„!
                  </div>
                </div>
              }
            </div>

            <!-- Confirm Password Field -->
            <div class="mb-3">
              <label for="confirmPassword" class="form-label">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
              <input
                type="password"
                class="form-control"
                id="confirmPassword"
                name="confirmPassword"
                [(ngModel)]="confirmPassword"
                #confirmPasswordField="ngModel"
                required
                minlength="6"
                [class.is-valid]="confirmPasswordField.valid && passwordsMatch() && (confirmPasswordField.dirty || confirmPasswordField.touched || submitted)"
                [class.is-invalid]="(confirmPasswordField.invalid || !passwordsMatch()) && (confirmPasswordField.dirty || confirmPasswordField.touched || submitted)"
                placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
              />
              
              @if(confirmPasswordField.valid && passwordsMatch() && (confirmPasswordField.dirty || confirmPasswordField.touched || submitted)) {
                <div class="valid-feedback">
                  âœ“ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©!
                </div>
              }

              @if(confirmPasswordField.errors?.['required'] && (confirmPasswordField.dirty || confirmPasswordField.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-danger mt-2 py-1 mb-0">
                    âš ï¸ ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨!
                  </div>
                </div>
              }

              @if(confirmPasswordField.errors?.['minlength'] && (confirmPasswordField.dirty || confirmPasswordField.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-warning mt-2 py-1 mb-0">
                    âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„!
                  </div>
                </div>
              }

              @if(!passwordsMatch() && confirmPasswordField.valid && (confirmPasswordField.dirty || confirmPasswordField.touched || submitted)) {
                <div class="invalid-feedback">
                  <div class="alert alert-danger mt-2 py-1 mb-0">
                    âš ï¸ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©!
                  </div>
                </div>
              }
            </div>

            <!-- Role Selection -->
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</label>
              <div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="role"
                    id="roleUser"
                    value="user"
                    [(ngModel)]="user.role"
                  />
                  <label class="form-check-label" for="roleUser">
                    Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ ğŸ‘¤
                  </label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="role"
                    id="roleAdmin"
                    value="admin"
                    [(ngModel)]="user.role"
                  />
                  <label class="form-check-label" for="roleAdmin">
                    Ù…Ø³Ø¤ÙˆÙ„ (Admin) ğŸ‘‘
                  </label>
                </div>
              </div>
            </div>

            <!-- Submit & Reset Buttons -->
            <div class="d-grid gap-2">
              <button
                type="submit"
                class="btn btn-primary btn-lg"
                [disabled]="isLoading"
              >
                @if(!isLoading) {
                  <span>ØªØ³Ø¬ÙŠÙ„ ğŸš€</span>
                }
                @if(isLoading) {
                  <span>
                    <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...
                  </span>
                }
              </button>
              
              <button
                type="button"
                class="btn btn-secondary"
                (click)="resetForm(signupForm)"
                [disabled]="isLoading"
              >
                Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
              </button>
            </div>

            <!-- Already have account -->
            <div class="text-center mt-3">
              <p class="text-muted">
                Ø¹Ù†Ø¯Ùƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ 
                <a routerLink="/login" class="text-primary fw-bold">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„!</a>
              </p>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>